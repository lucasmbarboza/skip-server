# /etc/stunnel/stunnel.conf
# Configuração SKIP Server - RFC SKIP compliant

# Configurações globais
pid = /var/run/stunnel4/stunnel.pid
output = /var/log/stunnel4/stunnel.log
debug = 5

# Configurações de segurança
fips = no
engine = auto

# Configurações TLS
options = NO_SSLv2
options = NO_SSLv3
options = NO_TLSv1
options = NO_TLSv1_1
# Permitir apenas TLS 1.2 e 1.3 conforme RFC SKIP

[skip-psk-server]
# SKIP Server com TLS PSK (Recommended - RFC SKIP Table 1)
accept = 443
connect = 127.0.0.1:8080

# Configurações TLS PSK conforme RFC SKIP
ciphers = DHE-PSK-AES256-CBC-SHA384:DHE-PSK-AES256-CBC-SHA:ECDHE-PSK-AES256-CBC-SHA384
PSKsecrets = psk.txt

# Configurações de protocolo
protocol = https
sslVersion = TLSv1.2

# Configurações de certificado (backup para modo certificate se necessário)
# cert = /etc/stunnel/server.crt
# key = /etc/stunnel/server.key

# Configurações de segurança adicional
# Verificação de certificado cliente (se usado)
# verify = 2
# CAfile = /etc/stunnel/ca.crt

# Configurações de performance
socket = l:TCP_NODELAY=1
socket = r:TCP_NODELAY=1

# Configurações de timeout
TIMEOUTclose = 0
TIMEOUTconnect = 10
TIMEOUTidle = 43200

# Configurações de logging
output = /var/log/stunnel4/skip-server.log
debug = 4